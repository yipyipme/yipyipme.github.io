var ye=Object.defineProperty;var be=(a,s,r)=>s in a?ye(a,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[s]=r;var I=(a,s,r)=>be(a,typeof s!="symbol"?s+"":s,r);import{c as C,s as k,i as ee,k as fe,r as p,w as se,j as e,P as ae,h as F,B as N,K as je,aj as we,a3 as R,m as V,N as L,O as H,Q as O,W as X,X as P,q as Ne,l as ke,ak as te,_ as G,F as Ce,z as Z,H as J,S as Se,J as De,al as T,x as Fe,D as Ue}from"./index-Ct_SM0vh.js";import{C as Me,a as Pe,b as _e,d as Be}from"./card-INzX4pkU.js";import{A as Ie,a as Ve}from"./alert-CtKX3wDI.js";import{T as Te}from"./textarea-CBKetNLb.js";import{C as ze}from"./circle-alert-CsA9kWpQ.js";import{R as re}from"./radio-C0_lv_wC.js";import{M as Ee}from"./message-square-82MjDiG_.js";import{B as $e}from"./book-open-DSlMyBw5.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=C("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=C("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=C("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=C("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=C("FileVideo",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m10 11 5 3-5 3v-6Z",key:"7ntvm4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=C("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=C("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=C("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=C("SquarePlay",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"m9 8 6 4-6 4Z",key:"f1r3lt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=C("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=C("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);class _{static getFileContentType(s){const r=s.toLowerCase().split(".").pop();return{mp4:"video/mp4",mov:"video/quicktime",avi:"video/x-msvideo",webm:"video/webm",mkv:"video/x-matroska",flv:"video/x-flv",wmv:"video/x-ms-wmv",m4v:"video/x-m4v","3gp":"video/3gpp"}[r||""]||"video/mp4"}static async createUploadSession(s,r,o={}){const n=this.CHUNK_SIZE,t=Math.ceil(s.size/n),{data:i,error:l}=await k.from("upload_sessions").insert({user_id:r,filename:s.name,total_size:s.size,chunk_size:n,total_chunks:t,metadata:{...o,file_type:s.type,last_modified:s.lastModified}}).select().single();if(l)throw l;return i}static async uploadFileInChunks(s,r,o,n,t,i){const{chunk_size:l,total_chunks:d,id:c}=r;let h=r.uploaded_chunks;await this.updateSessionStatus(c,"uploading");const x=[];for(let u=0;u<d;u++){const v=u*l,f=Math.min(v+l,s.size);x.push(s.slice(v,f))}for(let u=h;u<d;u++)try{await this.uploadChunk(x[u],o,n,u,c,s.name),h++;const v={sessionId:c,chunkIndex:u,totalChunks:d,uploadedBytes:h*l,totalBytes:s.size,percentage:Math.round(h/d*100),currentChunkProgress:100};t==null||t(v),await this.updateSessionProgress(c,h)}catch(v){console.error(`Failed to upload chunk ${u}:`,v),i==null||i(v,u);let f=0;for(;f<this.MAX_RETRIES;)try{await this.uploadChunk(x[u],o,n,u,c,s.name),h++;break}catch{if(f++,f>=this.MAX_RETRIES)throw await this.updateSessionStatus(c,"failed"),new Error(`Failed to upload chunk ${u} after ${this.MAX_RETRIES} retries`);await new Promise(g=>setTimeout(g,1e3*f))}}try{const u=await this.combineChunks(o,n,d,s.name);return await this.updateSessionStatus(c,"completed"),u}catch(u){throw await this.updateSessionStatus(c,"failed"),u}}static async uploadChunk(s,r,o,n,t,i){const l=`${o}_chunk_${n}`,d=this.getFileContentType(i),{error:c}=await k.storage.from(r).upload(l,s,{upsert:!0,contentType:d});if(c)throw c}static async combineChunks(s,r,o,n){const t=`${r}_chunk_0`,i=r,l=this.getFileContentType(n),{data:d,error:c}=await k.storage.from(s).download(t);if(c)throw c;const{error:h}=await k.storage.from(s).upload(i,d,{upsert:!0,contentType:l});if(h)throw h;const x=[];for(let v=0;v<o;v++)x.push(`${r}_chunk_${v}`);await k.storage.from(s).remove(x);const{data:{publicUrl:u}}=k.storage.from(s).getPublicUrl(i);return u}static async updateSessionStatus(s,r){const{error:o}=await k.from("upload_sessions").update({status:r,updated_at:new Date().toISOString()}).eq("id",s);if(o)throw o}static async updateSessionProgress(s,r){const{error:o}=await k.from("upload_sessions").update({uploaded_chunks:r,updated_at:new Date().toISOString()}).eq("id",s);if(o)throw o}static async getUploadSession(s){const{data:r,error:o}=await k.from("upload_sessions").select("*").eq("id",s).single();return o?null:r}static async cancelUploadSession(s){await this.updateSessionStatus(s,"cancelled")}static async cleanupFailedUploads(s,r){const o=await this.getUploadSession(r);if(o)for(let n=0;n<o.total_chunks;n++){const t=`${o.filename}_chunk_${n}`;await k.storage.from(s).remove([t])}}}I(_,"CHUNK_SIZE",5*1024*1024),I(_,"MAX_RETRIES",3);const Ge=()=>{const{user:a}=ee(),{toast:s}=fe(),[r,o]=p.useState({isUploading:!1,progress:0,currentFile:null,error:null,session:null,canResume:!1,isPaused:!1}),[n,t]=p.useState(null),i=p.useCallback(m=>{const g=[".mp4",".mov",".avi",".webm",".mkv",".flv",".wmv",".m4v",".3gp"],b=m.name.toLowerCase(),j=g.some(M=>b.endsWith(M));return["video/mp4","video/mov","video/avi","video/webm","video/quicktime","video/x-msvideo"].includes(m.type)||m.type==="application/octet-stream"&&j},[]),l=p.useCallback((m,g)=>{const b={video:2147483648,image:10485760};if(m.size>b[g])return`File size must be less than ${g==="video"?"2GB":"10MB"}`;if(g==="video"){if(!i(m))return"Invalid video file. Please upload MP4, MOV, AVI, WebM, or other supported video formats."}else{const j=["image/jpeg","image/png","image/webp"];if(!j.includes(m.type))return`Invalid file type. Allowed types: ${j.join(", ")}`}return null},[i]);p.useCallback(m=>{o(g=>({...g,progress:m,error:null}))},[]);const d=p.useCallback((m,g)=>{console.error("Upload error:",m,"at chunk:",g),o(b=>({...b,error:m.message,canResume:!1})),s({title:"Upload Error",description:m.message,variant:"destructive"})},[s]),c=p.useCallback(async(m,g={})=>{if(!a)return s({title:"Authentication Required",description:"Please log in to upload videos",variant:"destructive"}),null;const b=l(m,"video");if(b)return o(j=>({...j,error:b})),s({title:"Invalid File",description:b,variant:"destructive"}),null;try{o(D=>({...D,isUploading:!0,progress:0,currentFile:m.name,error:null,isPaused:!1}));const{url:j}=await se.uploadVideo(m,a.id);return o(D=>({...D,isUploading:!1,progress:100,currentFile:null,session:null})),s({title:"Upload Successful",description:"Your video has been uploaded successfully"}),j}catch(j){return d(j),o(D=>({...D,isUploading:!1,currentFile:null})),null}},[a,l,d,s]),h=p.useCallback(async m=>{if(!a)return null;const g=l(m,"image");if(g)return s({title:"Invalid Thumbnail",description:g,variant:"destructive"}),null;try{const b=m.name.split(".").pop(),j=`${a.id}/${Date.now()}_thumb.${b}`,{data:D,error:U}=await k.storage.from("thumbnails").upload(j,m);if(U)throw U;const{data:{publicUrl:M}}=k.storage.from("thumbnails").getPublicUrl(j);return M}catch(b){return d(b),null}},[a,l,d,s]),x=p.useCallback(()=>{n&&n.abort(),o(m=>({...m,isPaused:!0}))},[n]),u=p.useCallback(async()=>{o(m=>({...m,isPaused:!1}))},[]),v=p.useCallback(async()=>{n&&n.abort(),r.session&&(await _.cancelUploadSession(r.session.id),await _.cleanupFailedUploads("videos",r.session.id)),o({isUploading:!1,progress:0,currentFile:null,error:null,session:null,canResume:!1,isPaused:!1}),s({title:"Upload Cancelled",description:"Your upload has been cancelled and cleaned up"})},[n,r.session,s]),f=p.useCallback(()=>{o({isUploading:!1,progress:0,currentFile:null,error:null,session:null,canResume:!1,isPaused:!1})},[]);return{uploadState:r,uploadVideo:c,uploadThumbnail:h,pauseUpload:x,resumeUpload:u,cancelUpload:v,resetUpload:f}};function Ze(a,s=[]){let r=[];function o(t,i){const l=p.createContext(i),d=r.length;r=[...r,i];function c(x){const{scope:u,children:v,...f}=x,m=(u==null?void 0:u[a][d])||l,g=p.useMemo(()=>f,Object.values(f));return e.jsx(m.Provider,{value:g,children:v})}function h(x,u){const v=(u==null?void 0:u[a][d])||l,f=p.useContext(v);if(f)return f;if(i!==void 0)return i;throw new Error(`\`${x}\` must be used within \`${t}\``)}return c.displayName=t+"Provider",[c,h]}const n=()=>{const t=r.map(i=>p.createContext(i));return function(l){const d=(l==null?void 0:l[a])||t;return p.useMemo(()=>({[`__scope${a}`]:{...l,[a]:d}}),[l,d])}};return n.scopeName=a,[o,Je(n,...s)]}function Je(...a){const s=a[0];if(a.length===1)return s;const r=()=>{const o=a.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(t){const i=o.reduce((l,{useScope:d,scopeName:c})=>{const x=d(t)[`__scope${c}`];return{...l,...x}},{});return p.useMemo(()=>({[`__scope${s.scopeName}`]:i}),[i])}};return r.scopeName=s.scopeName,r}var A="Progress",q=100,[Ye,ks]=Ze(A),[Ke,We]=Ye(A),ie=p.forwardRef((a,s)=>{const{__scopeProgress:r,value:o=null,max:n,getValueLabel:t=Qe,...i}=a;(n||n===0)&&!W(n)&&console.error(es(`${n}`,"Progress"));const l=W(n)?n:q;o!==null&&!Q(o,l)&&console.error(ss(`${o}`,"Progress"));const d=Q(o,l)?o:null,c=B(d)?t(d,l):void 0;return e.jsx(Ke,{scope:r,value:d,max:l,children:e.jsx(ae.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":B(d)?d:void 0,"aria-valuetext":c,role:"progressbar","data-state":de(d,l),"data-value":d??void 0,"data-max":l,...i,ref:s})})});ie.displayName=A;var le="ProgressIndicator",ce=p.forwardRef((a,s)=>{const{__scopeProgress:r,...o}=a,n=We(le,r);return e.jsx(ae.div,{"data-state":de(n.value,n.max),"data-value":n.value??void 0,"data-max":n.max,...o,ref:s})});ce.displayName=le;function Qe(a,s){return`${Math.round(a/s*100)}%`}function de(a,s){return a==null?"indeterminate":a===s?"complete":"loading"}function B(a){return typeof a=="number"}function W(a){return B(a)&&!isNaN(a)&&a>0}function Q(a,s){return B(a)&&!isNaN(a)&&a<=s&&a>=0}function es(a,s){return`Invalid prop \`max\` of value \`${a}\` supplied to \`${s}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${q}\`.`}function ss(a,s){return`Invalid prop \`value\` of value \`${a}\` supplied to \`${s}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${q} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var ue=ie,as=ce;const me=p.forwardRef(({className:a,value:s,...r},o)=>e.jsx(ue,{ref:o,className:F("relative h-4 w-full overflow-hidden rounded-full bg-secondary",a),...r,children:e.jsx(as,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));me.displayName=ue.displayName;const ts=({uploadState:a,onPause:s,onResume:r,onCancel:o})=>a.isUploading?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-300",children:["Uploading: ",a.currentFile]}),e.jsxs("div",{className:"flex gap-2",children:[a.isPaused?e.jsx(N,{size:"sm",variant:"outline",onClick:r,children:e.jsx(je,{className:"h-4 w-4"})}):e.jsx(N,{size:"sm",variant:"outline",onClick:s,children:e.jsx(we,{className:"h-4 w-4"})}),e.jsx(N,{size:"sm",variant:"outline",onClick:o,children:e.jsx(R,{className:"h-4 w-4"})})]})]}),e.jsx(me,{value:a.progress,className:"w-full"}),e.jsxs("div",{className:"text-sm text-gray-400 text-center",children:[a.progress,"% completed",a.isPaused&&" (Paused)"]})]}):null;let z=null,E=null,$=null;try{z=require("@uppy/core").default,E=require("@uppy/dashboard").default,$=require("@uppy/tus").default}catch{}const rs="https://pmkxpohsoxogtvdyopmc.supabase.co/storage/v1/upload/resumable",os="videos",ns=({userId:a,onUploadSuccess:s,onUploadError:r,onProgress:o,disabled:n=!1,maxFileSizeMB:t=51200})=>{const i=p.useRef(null),l="uppy-dashboard-root";return p.useEffect(()=>{if(!a||!z||!E||!$)return;i.current&&i.current.close();const d=z({restrictions:{maxNumberOfFiles:1,maxFileSize:t*1024*1024,allowedFileTypes:["video/*",".mp4",".mov",".avi",".webm",".mkv",".flv",".wmv",".m4v",".3gp"]},autoProceed:!1}).use(E,{trigger:`#${l}`,inline:!0,target:`#${l}`,showProgressDetails:!0,hideUploadButton:!1,proudlyDisplayPoweredByUppy:!1,note:`Max video size: ${t} MB`,disabled:n}).use($,{endpoint:rs,chunkSize:6*1024*1024,retryDelays:[0,1e3,3e3,5e3],headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBta3hwb2hzb3hvZ3R2ZHlvcG1jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk5MDg3OTEsImV4cCI6MjA2NTQ4NDc5MX0.Nm4IOIE9RQggrL42h2qAhj-y52hXhE_aZeoaXCs9qxo"},allowedMetaFields:["bucketName","objectName","contentType"]});return d.on("file-added",c=>{d.setFileMeta(c.id,{bucketName:os,objectName:`${a}/${Date.now()}_${c.name}`,contentType:c.type})}),d.on("upload-progress",(c,h)=>{h&&h.percentage!==void 0&&o(Math.floor(h.percentage))}),d.on("complete",c=>{if(c.successful.length>0){const h=c.successful[0],u=`https://pmkxpohsoxogtvdyopmc.supabase.co/storage/v1/object/public/videos/${h.meta.objectName}`;s(u,h.data)}else r("Upload did not complete successfully")}),d.on("error",c=>{r(typeof c=="string"?c:c.message||"Unknown upload error")}),i.current=d,()=>{d.close()}},[a,n,t,o,r,s]),e.jsxs("div",{children:[e.jsx("div",{id:l,style:{minHeight:300,background:"#18181b",borderRadius:10,padding:6}}),e.jsx("div",{className:"text-xs text-center mt-2 text-zinc-400",children:"Paid plans support up to 50GB per video. Free plans are limited to 50MB max."})]})},is=({videoFile:a,thumbnailFile:s,onVideoFileChange:r,onThumbnailChange:o,disabled:n=!1})=>{const t=i=>{const l=i/1048576;return l>=1024?`${(l/1024).toFixed(1)} GB`:`${l.toFixed(1)} MB`};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Video File *"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-700 rounded-lg p-6 text-center hover:border-[#FDBD34] transition-colors",children:[e.jsx("input",{type:"file",accept:"video/*,.mp4,.mov,.avi,.webm,.mkv,.flv,.wmv,.m4v,.3gp",onChange:r,className:"hidden",id:"video-upload",disabled:n}),e.jsxs("label",{htmlFor:"video-upload",className:"cursor-pointer",children:[e.jsx(qe,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-300 mb-2",children:a?e.jsxs("span",{children:[a.name," (",t(a.size),")"]}):"Click to select video file or drag & drop"}),e.jsx("p",{className:"text-sm text-gray-500",children:"MP4, MOV, AVI, WebM, MKV and other video formats up to 2GB"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Thumbnail (Optional)"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-700 rounded-lg p-6 text-center hover:border-[#FDBD34] transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:o,className:"hidden",id:"thumbnail-upload",disabled:n}),e.jsxs("label",{htmlFor:"thumbnail-upload",className:"cursor-pointer",children:[e.jsx(Le,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),e.jsx("p",{className:"text-gray-300 text-sm",children:s?s.name:"Click to select thumbnail"})]})]})]})]})},ls=({userId:a,videoFile:s,thumbnailFile:r,onVideoFileChange:o,onThumbnailChange:n,onResumableUpload:t,onUppyError:i,onProgress:l,resetUpload:d,disabled:c,maxFileSizeMB:h,onNext:x})=>e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-lg text-white font-semibold mb-2",children:"Video File *"}),e.jsx(ns,{userId:a,onUploadSuccess:t,onUploadError:i,onProgress:l,disabled:c,maxFileSizeMB:h}),e.jsx(is,{videoFile:s,thumbnailFile:r,onVideoFileChange:o,onThumbnailChange:n,disabled:!0}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsx(N,{onClick:x,disabled:!s,className:"bg-[#FDBD34] text-black hover:bg-[#FDBD34]/80",children:"Next: Video Details"})})]}),cs=({formData:a,onFormDataChange:s,categories:r})=>{const o=t=>{t&&!a.tags.includes(t)&&s({tags:[...a.tags,t]})},n=t=>{s({tags:a.tags.filter(i=>i!==t)})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Title *"}),e.jsx(V,{value:a.title,onChange:t=>s({title:t.target.value}),placeholder:"Enter video title",className:"bg-gray-800 border-gray-700 text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description"}),e.jsx(Te,{value:a.description,onChange:t=>s({description:t.target.value}),placeholder:"Describe your video content",rows:4,className:"bg-gray-800 border-gray-700 text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Category"}),e.jsxs(L,{value:a.category,onValueChange:t=>s({category:t}),children:[e.jsx(H,{className:"bg-gray-800 border-gray-700 text-white",children:e.jsx(O,{placeholder:"Select category"})}),e.jsx(X,{className:"bg-gray-800 border-gray-700",children:r.map(t=>e.jsx(P,{value:t,className:"text-white",children:t},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:a.tags.map(t=>e.jsxs(Ne,{variant:"secondary",className:"bg-[#FDBD34]/20 text-[#FDBD34]",children:[t,e.jsx("button",{onClick:()=>n(t),className:"ml-2 text-[#FDBD34] hover:text-red-400",children:"×"})]},t))}),e.jsx(V,{placeholder:"Add tags (press Enter)",className:"bg-gray-800 border-gray-700 text-white",onKeyDown:t=>{t.key==="Enter"&&(t.preventDefault(),o(t.currentTarget.value),t.currentTarget.value="")}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Visibility"}),e.jsxs(L,{value:a.visibility,onValueChange:t=>s({visibility:t}),children:[e.jsx(H,{className:"bg-gray-800 border-gray-700 text-white",children:e.jsx(O,{})}),e.jsxs(X,{className:"bg-gray-800 border-gray-700",children:[e.jsx(P,{value:"public",className:"text-white",children:"Public"}),e.jsx(P,{value:"unlisted",className:"text-white",children:"Unlisted"}),e.jsx(P,{value:"private",className:"text-white",children:"Private"})]})]})]})]})},ds=({formData:a,onFormDataChange:s,categories:r,onBack:o,onSubmit:n,isUploading:t,uploadProgress:i})=>e.jsxs(e.Fragment,{children:[e.jsx(cs,{formData:a,onFormDataChange:s,categories:r}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(N,{variant:"outline",onClick:o,className:"border-gray-700 text-gray-300",disabled:t,children:"Back"}),e.jsx(N,{onClick:n,disabled:!a.title||t,className:"bg-[#FDBD34] text-black hover:bg-[#FDBD34]/80",children:t?e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"h-4 w-4 mr-2 animate-spin"}),"Uploading... (",i,"%)"]}):"Upload Video"})]})]}),us=({onClose:a,onSuccess:s})=>{const{user:r}=ee(),[o,n]=p.useState(1),[t,i]=p.useState(null),[l,d]=p.useState(null),[c,h]=p.useState({title:"",description:"",category:"",tags:[],visibility:"public",monetization_enabled:!1,video_url:""}),{uploadState:x,uploadVideo:u,uploadThumbnail:v,pauseUpload:f,resumeUpload:m,cancelUpload:g,resetUpload:b}=Ge(),j=["Sermons","Bible Study","Worship","Testimonies","Youth","Kids","Music","Prayer","Devotionals","Teaching","Events","Other"],D=w=>{var S;const y=(S=w.target.files)==null?void 0:S[0];y&&(console.log("Video file selected:",y.name,y.size,y.type),i(y),b())},U=w=>{var S;const y=(S=w.target.files)==null?void 0:S[0];y&&(console.log("Thumbnail file selected:",y.name,y.size,y.type),d(y))},M=w=>{h(y=>({...y,...w}))},pe=(w,y)=>{i(y),h(S=>({...S,video_url:w})),b()},he=w=>{console.error("Uppy Error:",w)},xe=async()=>{if(!r||!t){console.error("Missing user or video file");return}try{const w=c.video_url;if(!w){console.error("Video upload failed - no URL returned");return}let y;l&&(y=await v(l)??void 0);const S={creator_id:r.id,title:c.title,description:c.description,video_url:w,thumbnail_url:y,category:c.category,tags:c.tags,visibility:c.visibility,monetization_enabled:c.monetization_enabled,file_size:t.size,video_format:t.type,status:"published",processing_status:"completed",published_at:new Date().toISOString()};console.log("Video data to save:",S);const ve=await se.createVideo(S);console.log("Video saved to database:",ve),s(),a()}catch(w){console.error("Upload failed:",w)}},ge=()=>{x.isUploading&&g(),a()};return e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs(Me,{className:"w-full max-w-2xl bg-gray-900 border-gray-800 max-h-[90vh] overflow-y-auto",children:[e.jsxs(Pe,{className:"flex flex-row items-center justify-between",children:[e.jsx(_e,{className:"text-white",children:"Upload Video"}),e.jsx(N,{variant:"ghost",size:"icon",onClick:ge,className:"text-gray-400 hover:text-white",children:e.jsx(R,{className:"h-5 w-5"})})]}),e.jsxs(Be,{className:"space-y-6",children:[x.error&&e.jsxs(Ie,{className:"border-red-600 bg-red-950/50",children:[e.jsx(ze,{className:"h-4 w-4"}),e.jsxs(Ve,{className:"text-red-400",children:[x.error,x.canResume&&e.jsx(N,{variant:"link",className:"text-red-400 p-0 ml-2",onClick:m,children:"Try Resume"})]})]}),e.jsx(ts,{uploadState:x,onPause:f,onResume:m,onCancel:g}),o===1&&(r==null?void 0:r.id)&&e.jsx(ls,{userId:r.id,videoFile:t,thumbnailFile:l,onVideoFileChange:D,onThumbnailChange:U,onResumableUpload:pe,onUppyError:he,onProgress:()=>{},resetUpload:b,disabled:x.isUploading,maxFileSizeMB:51200,onNext:()=>n(2)}),o===2&&e.jsx(ds,{formData:c,onFormDataChange:M,categories:j,onBack:()=>n(1),onSubmit:xe,isUploading:x.isUploading,uploadProgress:x.progress})]})]})})},ms=({isSidebarOpen:a,onToggleSidebar:s,onShowUpload:r})=>{const o=ke(),n=()=>{console.log("Go Live button clicked, navigating to /creator-studio/live"),o("/creator-studio/live")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/lovable-uploads/30159a4f-685f-4d6b-a3c6-a2650c1d9bbc.png",alt:"YipYip",className:"h-8 w-auto neon-glow"}),a&&e.jsx("span",{className:"text-white font-bold text-lg",children:"Creator Studio"})]}),e.jsx(N,{variant:"ghost",size:"icon",onClick:s,className:"text-gray-400 hover:text-[#FDBD34] btn-modern",children:a?e.jsx(R,{className:"h-5 w-5"}):e.jsx(te,{className:"h-5 w-5"})})]}),a&&e.jsx("div",{className:"p-4 border-b border-gray-800",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(N,{onClick:r,className:"bg-[#FDBD34] text-black hover:bg-[#FDBD34]/80 btn-modern",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Upload"]}),e.jsxs(N,{onClick:n,variant:"outline",className:"border-gray-700 text-gray-300 hover:text-[#FDBD34] btn-modern",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Go Live"]})]})})]})},ps=[{name:"Overview",href:"/creator-studio",icon:oe,badge:null},{name:"Content",icon:G,badge:null,children:[{name:"Videos",href:"/creator-studio/videos",icon:G},{name:"Live Streams",href:"/creator-studio/live",icon:re},{name:"Playlists",href:"/creator-studio/playlists",icon:Oe},{name:"Drafts",href:"/creator-studio/drafts",icon:Ce}]},{name:"Analytics",icon:Y,badge:null,children:[{name:"Performance",href:"/creator-studio/analytics",icon:Y},{name:"Audience",href:"/creator-studio/analytics",icon:Z},{name:"Revenue",href:"/creator-studio/analytics",icon:K}]},{name:"Community",icon:Z,badge:"12",children:[{name:"Comments",href:"/creator-studio/comments",icon:Ee},{name:"Posts",href:"/creator-studio/posts",icon:$e},{name:"Prayer Requests",href:"/creator-studio/prayers",icon:J}]},{name:"Monetization",icon:K,badge:null,children:[{name:"Memberships",href:"/creator-studio/memberships",icon:Xe},{name:"Virtual Gifts",href:"/creator-studio/memberships",icon:Re},{name:"Donations",href:"/creator-studio/memberships",icon:J},{name:"Ad Settings",href:"/creator-studio/memberships",icon:Ae}]},{name:"Settings",href:"/creator-studio/settings",icon:Se,badge:null}],hs=({isSidebarOpen:a})=>{const[s,r]=p.useState(["Content"]),o=De(),n=t=>{r(i=>i.includes(t)?i.filter(l=>l!==t):[...i,t])};return e.jsx("nav",{className:"flex-1 p-4 space-y-2 overflow-y-auto",children:ps.map(t=>e.jsx("div",{children:t.children?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>n(t.name),className:F("flex items-center justify-between w-full px-3 py-2 rounded-lg text-gray-300 hover:bg-gray-800/50 hover:text-[#FDBD34] transition-all duration-300 btn-modern",s.includes(t.name)&&"text-[#FDBD34] bg-gray-800/30"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(t.icon,{className:"h-5 w-5"}),a&&e.jsx("span",{className:"font-medium",children:t.name})]}),t.badge&&a&&e.jsx("span",{className:"bg-[#FDBD34] text-black text-xs px-2 py-1 rounded-full font-bold",children:t.badge})]}),s.includes(t.name)&&a&&e.jsx("div",{className:"ml-6 mt-2 space-y-1",children:t.children.map(i=>e.jsxs(T,{to:i.href,className:F("flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:bg-gray-800/50 hover:text-[#FDBD34] transition-all duration-300 btn-modern text-sm",o.pathname===i.href&&"bg-gradient-to-r from-[#FDBD34]/20 to-[#FF8A3D]/20 text-[#FDBD34] font-semibold border border-[#FDBD34]/30"),children:[e.jsx(i.icon,{className:"h-4 w-4"}),i.name]},i.name))})]}):e.jsxs(T,{to:t.href,className:F("flex items-center justify-between px-3 py-2 rounded-lg text-gray-300 hover:bg-gray-800/50 hover:text-[#FDBD34] transition-all duration-300 btn-modern",o.pathname===t.href&&"bg-gradient-to-r from-[#FDBD34]/20 to-[#FF8A3D]/20 text-[#FDBD34] font-semibold border border-[#FDBD34]/30"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(t.icon,{className:"h-5 w-5"}),a&&e.jsx("span",{className:"font-medium",children:t.name})]}),t.badge&&a&&e.jsx("span",{className:"bg-[#FDBD34] text-black text-xs px-2 py-1 rounded-full font-bold",children:t.badge})]})},t.name))})},Cs=({children:a})=>{const[s,r]=p.useState(!0),[o,n]=p.useState(!1),t=()=>{window.location.reload()};return e.jsxs("div",{className:"min-h-screen bg-gray-950 flex w-full",children:[e.jsx("aside",{className:F("fixed left-0 top-0 z-50 h-full bg-gray-900/95 backdrop-blur-xl border-r border-gray-800 transform transition-transform duration-300 ease-out shadow-2xl","md:sticky md:transform-none",s?"translate-x-0 w-72":"-translate-x-full md:translate-x-0 md:w-16"),children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx(ms,{isSidebarOpen:s,onToggleSidebar:()=>r(!s),onShowUpload:()=>n(!0)}),e.jsx(hs,{isSidebarOpen:s}),e.jsx("div",{className:"p-4 border-t border-gray-800",children:e.jsxs(T,{to:"/",className:"flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-[#FDBD34] transition-colors btn-modern",children:[e.jsx(oe,{className:"h-4 w-4"}),s&&e.jsx("span",{className:"text-sm",children:"Back to Platform"})]})})]})}),e.jsxs("main",{className:F("flex-1 flex flex-col min-h-screen",s?"ml-0 md:ml-72":"ml-0 md:ml-16"),children:[e.jsx("header",{className:"bg-gray-900/50 backdrop-blur-xl border-b border-gray-800 px-4 py-4 w-full shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>r(!s),className:"text-gray-400 hover:text-[#FDBD34] btn-modern md:hidden",children:e.jsx(te,{className:"h-5 w-5"})}),e.jsxs("div",{className:"relative",children:[e.jsx(Fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(V,{placeholder:"Search videos, analytics, users...",className:"pl-10 w-80 bg-gray-800/50 border-gray-700 text-gray-100 placeholder-gray-400"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(N,{variant:"ghost",size:"icon",className:"text-gray-400 hover:text-[#FDBD34] btn-modern relative",children:[e.jsx(Ue,{className:"h-5 w-5"}),e.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full animate-pulse"})]}),e.jsx(N,{variant:"ghost",size:"icon",className:"text-gray-400 hover:text-[#FDBD34] btn-modern",children:e.jsx(He,{className:"h-5 w-5"})})]})]})}),e.jsx("div",{className:"flex-1 p-8 overflow-y-auto",children:a})]}),o&&e.jsx(us,{onClose:()=>n(!1),onSuccess:t})]})};export{Y as C,K as D,us as S,ne as U,Cs as a,Oe as b,Xe as c,Ae as d};
