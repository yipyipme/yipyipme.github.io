import{c as z,a as me,r as o,a5 as I,j as e,P as N,f as b,g as O,a6 as he,a7 as fe,a8 as pe,a9 as ve,aa as ye,ab as je,ac as be,ad as Ne,d as De,e as _,h as D,a3 as we,k as G,m as L,N as Ce,O as Se,Q as _e,W as Re,X as v,F as U,B as m,ae as w,af as Ee,S as B,q as W,z as Fe,s as Pe}from"./index-Ct_SM0vh.js";import{a as Ie}from"./CreatorStudioLayout-75gV8LXd.js";import{T as Oe}from"./textarea-CBKetNLb.js";import{L as y}from"./label-BVRhAaC2.js";import{S as $}from"./switch-DtbcJIXl.js";import{R as j}from"./radio-C0_lv_wC.js";import{C as R,a as E,b as F,d as P}from"./card-INzX4pkU.js";import{M as Te}from"./message-square-82MjDiG_.js";import{E as ke}from"./eye-C2eUJ_mm.js";import"./alert-CtKX3wDI.js";import"./circle-alert-CsA9kWpQ.js";import"./book-open-DSlMyBw5.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=z("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=z("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);var T="Dialog",[V,xt]=me(T),[Le,u]=V(T),q=t=>{const{__scopeDialog:s,children:r,open:i,defaultOpen:n,onOpenChange:a,modal:l=!0}=t,c=o.useRef(null),x=o.useRef(null),[g=!1,h]=De({prop:i,defaultProp:n,onChange:a});return e.jsx(Le,{scope:s,triggerRef:c,contentRef:x,contentId:_(),titleId:_(),descriptionId:_(),open:g,onOpenChange:h,onOpenToggle:o.useCallback(()=>h(S=>!S),[h]),modal:l,children:r})};q.displayName=T;var Y="DialogTrigger",Be=o.forwardRef((t,s)=>{const{__scopeDialog:r,...i}=t,n=u(Y,r),a=I(s,n.triggerRef);return e.jsx(N.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":A(n.open),...i,ref:a,onClick:b(t.onClick,n.onOpenToggle)})});Be.displayName=Y;var k="DialogPortal",[We,H]=V(k,{forceMount:void 0}),K=t=>{const{__scopeDialog:s,forceMount:r,children:i,container:n}=t,a=u(k,s);return e.jsx(We,{scope:s,forceMount:r,children:o.Children.map(i,l=>e.jsx(O,{present:r||a.open,children:e.jsx(Ne,{asChild:!0,container:n,children:l})}))})};K.displayName=k;var C="DialogOverlay",Q=o.forwardRef((t,s)=>{const r=H(C,t.__scopeDialog),{forceMount:i=r.forceMount,...n}=t,a=u(C,t.__scopeDialog);return a.modal?e.jsx(O,{present:i||a.open,children:e.jsx($e,{...n,ref:s})}):null});Q.displayName=C;var $e=o.forwardRef((t,s)=>{const{__scopeDialog:r,...i}=t,n=u(C,r);return e.jsx(he,{as:fe,allowPinchZoom:!0,shards:[n.contentRef],children:e.jsx(N.div,{"data-state":A(n.open),...i,ref:s,style:{pointerEvents:"auto",...i.style}})})}),p="DialogContent",X=o.forwardRef((t,s)=>{const r=H(p,t.__scopeDialog),{forceMount:i=r.forceMount,...n}=t,a=u(p,t.__scopeDialog);return e.jsx(O,{present:i||a.open,children:a.modal?e.jsx(ze,{...n,ref:s}):e.jsx(Ge,{...n,ref:s})})});X.displayName=p;var ze=o.forwardRef((t,s)=>{const r=u(p,t.__scopeDialog),i=o.useRef(null),n=I(s,r.contentRef,i);return o.useEffect(()=>{const a=i.current;if(a)return pe(a)},[]),e.jsx(Z,{...t,ref:n,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:b(t.onCloseAutoFocus,a=>{var l;a.preventDefault(),(l=r.triggerRef.current)==null||l.focus()}),onPointerDownOutside:b(t.onPointerDownOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0;(l.button===2||c)&&a.preventDefault()}),onFocusOutside:b(t.onFocusOutside,a=>a.preventDefault())})}),Ge=o.forwardRef((t,s)=>{const r=u(p,t.__scopeDialog),i=o.useRef(!1),n=o.useRef(!1);return e.jsx(Z,{...t,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var l,c;(l=t.onCloseAutoFocus)==null||l.call(t,a),a.defaultPrevented||(i.current||(c=r.triggerRef.current)==null||c.focus(),a.preventDefault()),i.current=!1,n.current=!1},onInteractOutside:a=>{var x,g;(x=t.onInteractOutside)==null||x.call(t,a),a.defaultPrevented||(i.current=!0,a.detail.originalEvent.type==="pointerdown"&&(n.current=!0));const l=a.target;((g=r.triggerRef.current)==null?void 0:g.contains(l))&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&n.current&&a.preventDefault()}})}),Z=o.forwardRef((t,s)=>{const{__scopeDialog:r,trapFocus:i,onOpenAutoFocus:n,onCloseAutoFocus:a,...l}=t,c=u(p,r),x=o.useRef(null),g=I(s,x);return ve(),e.jsxs(e.Fragment,{children:[e.jsx(ye,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:n,onUnmountAutoFocus:a,children:e.jsx(je,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":A(c.open),...l,ref:g,onDismiss:()=>c.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(Ue,{titleId:c.titleId}),e.jsx(qe,{contentRef:x,descriptionId:c.descriptionId})]})]})}),M="DialogTitle",J=o.forwardRef((t,s)=>{const{__scopeDialog:r,...i}=t,n=u(M,r);return e.jsx(N.h2,{id:n.titleId,...i,ref:s})});J.displayName=M;var ee="DialogDescription",te=o.forwardRef((t,s)=>{const{__scopeDialog:r,...i}=t,n=u(ee,r);return e.jsx(N.p,{id:n.descriptionId,...i,ref:s})});te.displayName=ee;var ae="DialogClose",se=o.forwardRef((t,s)=>{const{__scopeDialog:r,...i}=t,n=u(ae,r);return e.jsx(N.button,{type:"button",...i,ref:s,onClick:b(t.onClick,()=>n.onOpenChange(!1))})});se.displayName=ae;function A(t){return t?"open":"closed"}var re="DialogTitleWarning",[ut,ie]=be(re,{contentName:p,titleName:M,docsSlug:"dialog"}),Ue=({titleId:t})=>{const s=ie(re),r=`\`${s.contentName}\` requires a \`${s.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${s.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${s.docsSlug}`;return o.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},Ve="DialogDescriptionWarning",qe=({contentRef:t,descriptionId:s})=>{const i=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${ie(Ve).contentName}}.`;return o.useEffect(()=>{var a;const n=(a=t.current)==null?void 0:a.getAttribute("aria-describedby");s&&n&&(document.getElementById(s)||console.warn(i))},[i,t,s]),null},Ye=q,He=K,ne=Q,oe=X,le=J,ce=te,Ke=se;const Qe=Ye,Xe=He,de=o.forwardRef(({className:t,...s},r)=>e.jsx(ne,{ref:r,className:D("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s}));de.displayName=ne.displayName;const ge=o.forwardRef(({className:t,children:s,...r},i)=>e.jsxs(Xe,{children:[e.jsx(de,{}),e.jsxs(oe,{ref:i,className:D("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[s,e.jsxs(Ke,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(we,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ge.displayName=oe.displayName;const xe=({className:t,...s})=>e.jsx("div",{className:D("flex flex-col space-y-1.5 text-center sm:text-left",t),...s});xe.displayName="DialogHeader";const ue=o.forwardRef(({className:t,...s},r)=>e.jsx(le,{ref:r,className:D("text-lg font-semibold leading-none tracking-tight",t),...s}));ue.displayName=le.displayName;const Ze=o.forwardRef(({className:t,...s},r)=>e.jsx(ce,{ref:r,className:D("text-sm text-muted-foreground",t),...s}));Ze.displayName=ce.displayName;const Je=({isOpen:t,onClose:s,onStreamCreated:r})=>{const[i,n]=o.useState(!1),[a,l]=o.useState({title:"",description:"",category:"",visibility:"public",chat_enabled:!0,recording_enabled:!0,scheduled_start:""}),{toast:c}=G(),x=async g=>{g.preventDefault(),n(!0);try{await w.createStream({title:a.title,description:a.description,category:a.category,visibility:a.visibility,chat_enabled:a.chat_enabled,recording_enabled:a.recording_enabled,scheduled_start:a.scheduled_start?new Date(a.scheduled_start).toISOString():null,creator_id:""}),c({title:"Stream Created",description:"Your live stream has been set up successfully!"}),r(),s(),l({title:"",description:"",category:"",visibility:"public",chat_enabled:!0,recording_enabled:!0,scheduled_start:""})}catch(h){console.error("Error creating stream:",h),c({title:"Error",description:"Failed to create stream. Please try again.",variant:"destructive"})}finally{n(!1)}};return e.jsx(Qe,{open:t,onOpenChange:s,children:e.jsxs(ge,{className:"sm:max-w-md bg-gray-900 border-gray-800",children:[e.jsx(xe,{children:e.jsxs(ue,{className:"text-white flex items-center gap-2",children:[e.jsx(j,{className:"h-5 w-5 text-[#FDBD34]"}),"Create Live Stream"]})}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"title",className:"text-gray-300",children:"Stream Title"}),e.jsx(L,{id:"title",value:a.title,onChange:g=>l({...a,title:g.target.value}),className:"bg-gray-800 border-gray-700 text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"description",className:"text-gray-300",children:"Description"}),e.jsx(Oe,{id:"description",value:a.description,onChange:g=>l({...a,description:g.target.value}),className:"bg-gray-800 border-gray-700 text-white",rows:3})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"category",className:"text-gray-300",children:"Category"}),e.jsxs(Ce,{value:a.category,onValueChange:g=>l({...a,category:g}),children:[e.jsx(Se,{className:"bg-gray-800 border-gray-700 text-white",children:e.jsx(_e,{placeholder:"Select category"})}),e.jsxs(Re,{children:[e.jsx(v,{value:"worship",children:"Worship"}),e.jsx(v,{value:"sermon",children:"Sermon"}),e.jsx(v,{value:"bible-study",children:"Bible Study"}),e.jsx(v,{value:"prayer",children:"Prayer"}),e.jsx(v,{value:"youth",children:"Youth"}),e.jsx(v,{value:"kids",children:"Kids"})]})]})]}),e.jsxs("div",{children:[e.jsxs(y,{htmlFor:"scheduled_start",className:"text-gray-300 flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Schedule Start Time (Optional)"]}),e.jsx(L,{id:"scheduled_start",type:"datetime-local",value:a.scheduled_start,onChange:g=>l({...a,scheduled_start:g.target.value}),className:"bg-gray-800 border-gray-700 text-white"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(y,{htmlFor:"chat_enabled",className:"text-gray-300",children:"Enable Chat"}),e.jsx($,{id:"chat_enabled",checked:a.chat_enabled,onCheckedChange:g=>l({...a,chat_enabled:g})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(y,{htmlFor:"recording_enabled",className:"text-gray-300",children:"Enable Recording"}),e.jsx($,{id:"recording_enabled",checked:a.recording_enabled,onCheckedChange:g=>l({...a,recording_enabled:g})})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(m,{type:"button",variant:"outline",onClick:s,className:"flex-1",children:"Cancel"}),e.jsx(m,{type:"submit",disabled:i,className:"flex-1 bg-[#FDBD34] text-black hover:bg-[#FDBD34]/80",children:i?"Creating...":"Create Stream"})]})]})]})})},mt=()=>{const[t,s]=o.useState(!1);o.useState(null);const{toast:r}=G(),[i,n]=o.useState(null);o.useEffect(()=>{(async()=>{const{data:{user:f}}=await Pe.auth.getUser();n((f==null?void 0:f.id)||null)})()},[]);const{data:a=[],refetch:l}=Ee({queryKey:["creator-streams",i],queryFn:()=>i?w.getCreatorStreams(i):Promise.resolve([]),enabled:!!i}),c=a.find(d=>d.status==="live"),x=d=>{switch(d){case"live":return"bg-red-500 animate-pulse";case"scheduled":return"bg-blue-500";case"ended":return"bg-gray-500";default:return"bg-gray-500"}},g=(d,f)=>{navigator.clipboard.writeText(d),r({title:"Copied!",description:`${f} copied to clipboard`})},h=async d=>{try{await w.endStream(d),l(),r({title:"Stream Ended",description:"Your live stream has been ended successfully."})}catch{r({title:"Error",description:"Failed to end stream. Please try again.",variant:"destructive"})}},S=async d=>{try{await w.startStream(d),l(),r({title:"Stream Started",description:"Your live stream is now live!"})}catch{r({title:"Error",description:"Failed to start stream. Please try again.",variant:"destructive"})}};return e.jsxs(Ie,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Live Streams"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Manage your live streaming content"})]}),e.jsxs(m,{onClick:()=>s(!0),className:"bg-[#FDBD34] text-black hover:bg-[#FDBD34]/80",children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Create Stream"]})]}),c&&e.jsxs(R,{className:"bg-gray-900 border-gray-800",children:[e.jsx(E,{children:e.jsxs(F,{className:"text-white flex items-center gap-2",children:[e.jsx(j,{className:"h-5 w-5 text-red-500"}),"Live Control Panel - ",c.title]})}),e.jsxs(P,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:c.current_viewers||0}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Live Viewers"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-white",children:[c.actual_start?Math.floor((Date.now()-new Date(c.actual_start).getTime())/6e4):0,"m"]}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Stream Duration"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:c.max_viewers||0}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Peak Viewers"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:c.total_viewers||0}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Total Views"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(m,{onClick:()=>h(c.id),className:"bg-red-500 text-white hover:bg-red-600",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"End Stream"]}),e.jsxs(m,{variant:"outline",className:"border-gray-700 text-gray-300",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Stream Settings"]}),e.jsxs(m,{variant:"outline",className:"border-gray-700 text-gray-300",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Moderate Chat"]})]})]})]}),e.jsxs(R,{className:"bg-gray-900 border-gray-800",children:[e.jsx(E,{children:e.jsx(F,{className:"text-white",children:"Your Streams"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-4",children:a.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(j,{className:"h-16 w-16 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No streams yet. Create your first live stream!"})]}):a.map(d=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-800/30 rounded-lg hover:bg-gray-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-[#FDBD34] to-[#FF8A3D] rounded-lg flex items-center justify-center",children:e.jsx(j,{className:"h-8 w-8 text-black"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold",children:d.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-400 mt-1",children:[e.jsx(W,{className:`${x(d.status)} text-white`,children:d.status}),d.status==="live"?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Fe,{className:"h-3 w-3"}),d.current_viewers," watching"]}):d.scheduled_start?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(U,{className:"h-3 w-3"}),new Date(d.scheduled_start).toLocaleDateString()]}):null,d.category&&e.jsx(W,{variant:"outline",className:"border-[#FDBD34] text-[#FDBD34]",children:d.category})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[d.status==="scheduled"&&e.jsxs(m,{size:"sm",onClick:()=>S(d.id),className:"bg-[#FDBD34] text-black",children:[e.jsx(j,{className:"h-3 w-3 mr-1"}),"Go Live"]}),d.status==="live"&&e.jsxs(m,{size:"sm",className:"bg-green-500 text-white",children:[e.jsx(ke,{className:"h-3 w-3 mr-1"}),"Live"]}),e.jsxs(m,{size:"sm",variant:"outline",className:"border-gray-700 text-gray-300",children:[e.jsx(B,{className:"h-3 w-3 mr-1"}),"Settings"]})]})]},d.id))})})]}),e.jsxs(R,{className:"bg-gray-900 border-gray-800",children:[e.jsx(E,{children:e.jsx(F,{className:"text-white",children:"Stream Setup"})}),e.jsx(P,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold mb-3",children:"RTMP Settings"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Server URL:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-mono",children:"rtmp://live.yipyip.com/live/"}),e.jsx(m,{size:"sm",variant:"ghost",onClick:()=>g("rtmp://live.yipyip.com/live/","Server URL"),children:e.jsx(Me,{className:"h-3 w-3"})})]})]}),e.jsx("div",{className:"text-gray-400 text-xs",children:"Use your stream key from any of your created streams above"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold mb-3",children:"Recommended Settings"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-400",children:[e.jsx("div",{children:"• Resolution: 1920x1080 (1080p)"}),e.jsx("div",{children:"• Frame Rate: 30 FPS"}),e.jsx("div",{children:"• Video Bitrate: 4500-6000 kbps"}),e.jsx("div",{children:"• Audio Bitrate: 128 kbps"}),e.jsx("div",{children:"• Encoder: x264"})]})]})]})})]})]}),e.jsx(Je,{isOpen:t,onClose:()=>s(!1),onStreamCreated:()=>{l(),s(!1)}})]})};export{mt as default};
